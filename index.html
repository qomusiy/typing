<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>O'zbekcha Terish Testi</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <style>
    body {
      margin: 0;
      background-color: #1a1b26;
      color: #c0caf5;
      font-family: 'Courier New', monospace;
      height: 100vh;
      width: 100vw;
      overflow-x: hidden;
    }
    .container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      width: 100%;
      max-width: 900px;
      margin: 0 auto;
      text-align: center;
      padding: 20px;
    }
    #timer {
      font-size: 1.1rem;
      color: #7dcfff;
      margin-bottom: 6px;
      min-height: 1.4em;
    }
    .quote {
      font-size: 1.6rem;
      line-height: 2.4rem;
      word-wrap: break-word;
      user-select: none;
      margin: 10px 0 20px 0;
      text-align: left;
      width: 100%;
      max-height: 60vh;
      overflow-y: auto;
      white-space: pre-wrap;
      padding-right: 10px;
      border-radius: 6px;
      position: relative;
    }
    .quote span[data-original] {transition: color 0.06s ease;}
    .quote span.correct[data-original] {color: #9ece6a;}
    .quote span.incorrect[data-original] {color: #f7768e;}
    .quote span.extra {color: #ff6b6b;text-decoration: underline;}
    .cursor {
      display: inline-block;
      width: 2px;
      background-color: #7dcfff;
      animation: blink 3s infinite;
      vertical-align: bottom;
      margin-left: -1px;
      height: 1.4em;
    }
    @keyframes blink {
      0%, 50%, 100% {opacity: 1;}
      25%, 75% {opacity: 0;}
    }
    #stats {
      margin: 10px 0 20px 0;
      font-size: 1.05rem;
      color: #d900ff;
      min-height: 1.2em;
    }
    #restartLink {
      display: inline-block;
      margin: 6px 0 20px 0;
      padding: 10px 20px;
      font-size: 1rem;
      background-color: #2a2e45;
      color: white;
      border-radius: 6px;
      cursor: pointer;
      transition: opacity 0.3s ease;
      user-select: none;
    }
    #restartLink:hover {background-color: #3b3f5c;}
    .controls {
      display: flex;
      gap: 10px;
      margin: 10px 0;
      transition: opacity 0.3s ease;
      flex-wrap: wrap;
      justify-content:center;
    }
    .length-btn, .sound-toggle {
      padding: 8px 16px;
      font-size: 1rem;
      background-color: #2a2e45;
      color: #c0caf5;
      border: 1px solid #2a2e45;
      border-radius: 5px;
      text-decoration: none;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    .length-btn:hover, .sound-toggle:hover {background-color: #3b3f5c;}
    .length-btn.active, .sound-toggle.active {
      background-color: #7aa2f7;
      color: #1a1b26;
      border-color: #7aa2f7;
    }
    .sound-toggle i {margin-right: 5px;}
    h1 {transition: opacity 0.3s ease;margin: 10px 0;}
    .fade {opacity: 0;pointer-events: none;}
  </style>
</head>
<body>
  <div class="container">
    <h1 style="font-family: Georgia, serif;"> - O'zbekcha Tayping Qil Akasiüòé..</h1>
    <div class="controls">
      <a href="#" class="length-btn" data-length="short">Qisqa</a>
      <a href="#" class="length-btn active" data-length="medium">O'rta</a>
      <a href="#" class="length-btn" data-length="long">Uzun</a>
      <a href="#" class="length-btn" data-length="cs">CS TIIAME</a>
      <a href="#" class="sound-toggle active" id="soundToggle"><i class="fas fa-volume-up"></i></a>
    </div>
    <div id="timer">‚è± 00:00</div>
    <div class="quote" id="quote" aria-live="off"></div>
    <div id="stats"></div>
    <div id="restartLink">Qayta boshlashüîÑ</div>
    <audio id="correctSound1" src="c.wav" preload="auto"></audio>
    <audio id="correctSound2" src="c.wav" preload="auto"></audio>
    <audio id="correctSound3" src="c.wav" preload="auto"></audio>
    <audio id="incorrectSound1" src="i.wav" preload="auto"></audio>
    <audio id="incorrectSound2" src="i.wav" preload="auto"></audio>
    <audio id="incorrectSound3" src="i.wav" preload="auto"></audio>
    <audio id="testCompleteSound" src="s.wav" preload="auto"></audio>
  </div>
  <script>
    const quoteEl=document.getElementById('quote'),statsEl=document.getElementById('stats'),restartLink=document.getElementById('restartLink'),lengthButtons=document.querySelectorAll('.length-btn'),soundToggle=document.getElementById('soundToggle'),timerEl=document.getElementById('timer'),titleEl=document.querySelector('h1'),controlsEl=document.querySelector('.controls');
    const correctSounds=[correctSound1,correctSound2,correctSound3],incorrectSounds=[incorrectSound1,incorrectSound2,incorrectSound3],testCompleteSound=document.getElementById('testCompleteSound');
    let correctSoundIndex=0,incorrectSoundIndex=0;
    const quotes={
      short:[
        "Kelajakni bashorat qilishning eng yaxshi yo'li bu uni qurish.", 
        "Men yomon odam bo'lsam keragu, buni o'zim bilmasam kerak.", 
        "Shamdek yosh to'k, ko'ngil uying charog'on bo'lsin.", 
        "Kishi jasur bo'la olishi mumkin bo'lgan yagona vaqt, bu u qo'rqqanida.", 
        "Inson tabassumi bilan tarbiyasini, nimaga kulgani bilan saviyasini namoyon qiladi.", 
        "Kecha bu o'tmish, erta bu jumboq, lekin bugun bu tuhfa.", "Rim bir kunda qurilmagan.", 
        'Bilim Makkaga yetib borgan, lekin amal qilish "astanovka"da ham emas.', 
        "Muhimi shokolad emas. Siz uni baham ko'rgan odamlardir.", 
        "Qilishing kerak bo'lgan ishni qil va nima bo'sa bo'lsin.", 
        "Ikkita kitob o'qigandan bitta kitobni ikki marta o'qigan afzal."
      ],
      medium:[
        "Las Vegas kazinosida yutishning yagona yo'li bu kirganingizdan so'ng imkon qadar tez chiqib ketishdir.", 
        "Tanaga qilichdek muomala qilsang qilich bo'ladi. Qog'ozdek muomala qilsang qog'oz bo'ladi.", 
        'Kimdir "qila olaman", kimdir "qila olmayman" deydi. Odatda ularning ikkisi ham haq.', 
        "Jismoniy shug'ullanish nafaqat bizni sog'lom, kuchli, chidamli va ko'rkam qiladi, balki aqlan ham o'stiradi.", 
        "Odamlar suratini bezatsa, sen siyratingni beza. Odamlar boshqalar aybidan so'z ochsa, sen o'z qusuringni o'yla.", 
        "Ey, do'st! Men Majnun emasman, ammo chaqirsang cho'li biyobonga borishga ham tayyorman.", 
        "Mashrabo ko'p so'zlama, oqillara, bir so'z yetar! Kar quloq bo'lsa agar: ming so'zlagin bejo ketar!", 
        "O'ylaring so'zlaringga, so'zlaring fe'lingga, fe'ling taqdiringga nuqs etadi. Go'zal o'yla, go'zal yasha.", 
        "Agar nimadandir qo'rqsang, shu narsani har kuni bajar. Borgan sari qo'rquv umuman yo'q bo'lib ketadi.", 
        "Bilim ko'p narsani bilish. O'sha narsalarni eng yaxshi yo'lda ishlata olish esa donolikdir.", 
        "Chalg'imay ishlang, kitob o'qing, o'ylang, yuring, yozing - g'alaba aniq, sabr qila olsangiz bas."
      ],
      long:[
        "Bu katta va go'zal dunyo. Ko'pchiligimiz, uni hechqaysi bo'lagini umuman ko'rolmasdan, o'zimiz tug'ilgan bir burchakda yashab, o'tib ketamiz. Men ko'pchiligimiz dek bo'lishni istamayman.", 
        "Biz kelib ketuvchi to'garak jahon Na boshi ma'lum na so'ngi ayon Hech kimsa rostini aytib berolmas Biz qaydan keldigu ketarmiz qayon Keksa yosh hayotga har kimki yetar Hammasi izma-iz birma-bir o'tar Bu dunyo hech kimga qolmas abadiy Ketdilar, ketamiz, kelishar, ketar", 
        "Insonni otash emas, o'z g'aflati yoqar. Barchadagi kamchilikni ko'rar-u, ammo o'ziga ko'rdek boqar. Nimaga qanday boqsang, u ham senga shunday boqar.", 
        "Xato qilgan bo'lsang, tan ol. Adashayotgan bo'lsang, savol so'ra. Tiqilib qolgan bo'lsang, yordam so'ra. Xato qilgan bo'lsang, undan o'rgan. O'rgandingmi? O'rgat.", 
        "Xalq dengizdir, xalq to'lqindir, xalq kuchdir, Xalq isyondir, xalq olovdir, xalq o'chdir... Xalq qo'zg'alsa kuch yo'qdirkim, to'xtatsin, Quvvat yo'qkim, xalq istagin yo'q etsin.", 
        "Bir qo'lida Qur'onu bittasida jom, Bazida halolmiz, bazida harom, Feruza osmonli gumbaz ostida Na chin musulmonmiz, na kofir tamom."
      ],
      cs:[
        `Mash'ali fikrat - sening, ham changali vahshat sening,
G'ayratu g'aflat sening, javlon o'zing, uryon o'zing.

Qildingu oyda xirom, ham yerda qon to'kding harom,
Ushbu holingdan mudom xandon o'zing, giryon o'zing.

Minding ilm narvoniga, chiqding funun osmoniga,
Bu jahon ayvoniga arkon o'zing, vayron o'zing.

Zarrani ijod etib, dahshat balo bunyod etib,
Oqibatni yod etib, hayron o'zing, hayron o'zing.

Bog'i arz obod erur sendin agar imdod erur,
Yo'qsa u barbod erur, to'fon o'zing, to'g'on o'zing.

Sen hilol, yulduz, salib, Tavrot, Zaburdin yuksalib,
Boymisan yoki g'arib, komron o'zing, yakson o'zing.

Kim farangi, kim habash, irq, qon talash, iymon talash,
Shulmi insondek yashash, armon o'zing, afg'on o'zing.

Mamlakatga mamlakat, millatga millat bo'lsa qasd,
Qilg'uchi so'ng oqibat armon o'zing, afg'on o'zing.

Onayizoring - zamin, tanho yo'gu boring - zamin,
Xasta bemoring - zamin, o'g'lon o'zing, darmon o'zing.

Bag'rida yotquchi - sen, ne'matlarin totquchi - sen,
Tig' bo'lib botquchi - sen, paykon o'zing, qalqon o'zing.`]
};
    let currentQuote='',originalSpans=[],currentIndex=0,started=false,startTime=null,timerInterval=null,ended=false,currentLength='medium',soundEnabled=localStorage.getItem('soundEnabled')!=='false',typedHistory=[],cursorEl=null;
    function updateSoundToggle(){soundToggle.classList.toggle('active',soundEnabled);soundToggle.innerHTML=`<i class="fas ${soundEnabled?'fa-volume-up':'fa-volume-mute'}"></i>`;}
    updateSoundToggle();
    soundToggle.addEventListener('click',e=>{e.preventDefault();soundEnabled=!soundEnabled;localStorage.setItem('soundEnabled',soundEnabled);updateSoundToggle();});
    function getRandomQuote(l){const list=quotes[l];return list[Math.floor(Math.random()*list.length)];}
    function renderQuote(){quoteEl.innerHTML='';currentQuote.split('').forEach(ch=>{const s=document.createElement('span');s.innerText=ch;s.dataset.original='1';quoteEl.appendChild(s);});originalSpans=Array.from(quoteEl.querySelectorAll('span[data-original]'));currentIndex=0;cursorEl=document.createElement('span');cursorEl.className='cursor';quoteEl.insertBefore(cursorEl,originalSpans[0]);stopTimer();started=false;startTime=null;ended=false;typedHistory=[];statsEl.innerText='';timerEl.innerText='‚è± 00:00';quoteEl.scrollTop=0;}
    function startTest(l){currentLength=l||currentLength;currentQuote=getRandomQuote(currentLength);renderQuote();lengthButtons.forEach(b=>b.classList.toggle('active',b.dataset.length===currentLength));}
    function startTimerIfNeeded(){if(started)return;started=true;startTime=Date.now();timerInterval=setInterval(()=>{const e=Date.now()-startTime;timerEl.innerText='‚è± '+formatTime(e);},250);}
    function stopTimer(){if(timerInterval){clearInterval(timerInterval);timerInterval=null;}}
    function formatTime(ms){const s=Math.floor(ms/1000),m=String(Math.floor(s/60)).padStart(2,'0'),ss=String(s%60).padStart(2,'0');return`${m}:${ss}`;}
    function playCorrectSound(){if(!soundEnabled)return;const s=correctSounds[correctSoundIndex];s.currentTime=0;s.play().catch(()=>{});correctSoundIndex=(correctSoundIndex+1)%correctSounds.length;}
    function playIncorrectSound(){if(!soundEnabled)return;const s=incorrectSounds[incorrectSoundIndex];s.currentTime=0;s.play().catch(()=>{});incorrectSoundIndex=(incorrectSoundIndex+1)%incorrectSounds.length;}
    function currentOriginalSpan(){return originalSpans[currentIndex]||null;}
    function moveCursor(){const cur=currentOriginalSpan();if(cur)quoteEl.insertBefore(cursorEl,cur);else quoteEl.appendChild(cursorEl);cursorEl.scrollIntoView({block:'nearest',inline:'nearest'});}
    function insertExtraChar(ch){const s=document.createElement('span');s.classList.add('extra');s.innerText=ch;quoteEl.insertBefore(s,cursorEl);typedHistory.push({el:s,type:'extra'});}
    function removeLastTyped(){if(!typedHistory.length)return;const last=typedHistory.pop();if(last.type==='extra'){last.el.remove();}else if(last.type==='original'){last.el.classList.remove('correct','incorrect');if(currentIndex>0)currentIndex--;moveCursor();}}
    function computeStats(){const c=quoteEl.querySelectorAll('span[data-original].correct').length,i=quoteEl.querySelectorAll('span[data-original].incorrect').length,e=quoteEl.querySelectorAll('span.extra').length,t=c+i+e,a=t===0?100:Math.round((c/t)*100),ms=Date.now()-startTime,m=ms/60000,w=m>0?Math.round((c/5)/m):0;return{a,w,ms};}
    function finishTest(){ended=true;stopTimer();const{s,a,w,ms}=computeStats();statsEl.innerText=`Vaqt: ${formatTime(ms)} | WPM: ${w} | To'g'rilik: ${a}%`;if(soundEnabled)testCompleteSound.play().catch(()=>{});titleEl.classList.remove('fade');controlsEl.classList.remove('fade');}
    document.addEventListener('keydown',e=>{if(ended)return;if(e.ctrlKey||e.altKey||e.metaKey)return;if(['CapsLock','Shift','Tab','Escape'].includes(e.key))return;if(!started)startTimerIfNeeded();if(e.key===' '||e.key==='Enter')e.preventDefault();if(e.key==='Backspace'){removeLastTyped();return;}
      const typed=e.key==='Enter'?'\n':e.key;if(currentIndex>=originalSpans.length){if(typed.length===1||typed==='\n'){insertExtraChar(typed==='\n'?'_':typed);playIncorrectSound();}return;}
      const exp=originalSpans[currentIndex].innerText;
      if(typed===exp){originalSpans[currentIndex].classList.remove('incorrect');originalSpans[currentIndex].classList.add('correct');typedHistory.push({el:originalSpans[currentIndex],type:'original'});currentIndex++;moveCursor();playCorrectSound();if(currentIndex>=originalSpans.length)finishTest();return;}
      if(typed==='\n'&&exp!=='\n'){insertExtraChar('_');playIncorrectSound();return;}
      if(typed.length===1){insertExtraChar(typed);playIncorrectSound();}
    });
    restartLink.addEventListener('click',()=>startTest(currentLength));
    lengthButtons.forEach(b=>b.addEventListener('click',e=>{e.preventDefault();startTest(b.dataset.length);}));
    startTest();
  </script>
</body>
</html>
